From dd3ddb4f4c59d9b3e4de3938afc659379db2822c Mon Sep 17 00:00:00 2001
From: Daniel Kolesa <daniel@octaforge.org>
Date: Wed, 9 Mar 2022 00:10:51 +0100
Subject: [PATCH] package: fix error message when script fails to execute

Related: https://gitlab.alpinelinux.org/alpine/apk-tools/-/issues/10825
---
 src/package.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/src/package.c b/src/package.c
index 0b2c7d8..a1c2c66 100644
--- a/src/package.c
+++ b/src/package.c
@@ -845,7 +845,7 @@ void apk_ipkg_run_script(struct apk_installed_package *ipkg,
 	goto cleanup;
 
 err_log:
-	apk_err(out, "%s: failed to execute: %s", &fn[15], apk_error_str(errno));
+	apk_err(out, "%s: failed to execute: %s", &fn[strlen(script_exec_dir)+1], apk_error_str(errno));
 err:
 	ipkg->broken_script = 1;
 cleanup:
-- 
GitLab

